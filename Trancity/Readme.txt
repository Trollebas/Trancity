Прочитайте меня!

0) Установка и запуск

Установка осуществляется путём распаковки содержимого архива в любое удобное место.
Обращаю внимание: запуск игры напрямую из архива приведёт к непредсказуемым ошибкам!

Минимальные требования для запуска игры:
• Windows XP или выше;
• .NET Framework: 2.0 (только для Windows XP) или 3.5 SP1 (для более новых ОС Windows); 
• Последний DirectX 9.0c (Jun 2010);
• SlimDX Runtime для .NET 2.0 (скачать можно здесь: https://code.google.com/archive/p/slimdx/downloads);

Обязательные файлы для запуска:
DotR.dll, DotR.pdb, SlimDX.dll (необязательно).

1) Общее управление

Приведены английские названия клавиш. В скобочках указанно управление старого типа, для отдельной версии Trancity_oldCont.exe.

Можно поворачивать и перемещать камеру (относительно ТС или земли). 
Движение мыши поворачивает камеру, движение мыши с нажатой левой кнопкой перемещает камеру (горизонтально).
Поворот колёсика мыши перемещает камеру вверх и вниз.
Правая кнопка мыши освобождает камеру от ТС либо закрепляет на него.
Камеру можно закрепить на любое ТС. 
Для этого нужно приблизиться к этому транспортному средству в незакреплённом режиме и нажать правую кнопку мыши. 
При этом управление также перейдёт к выбранному ТС.
Чтобы отменить закрепление за ТС, можно нажать F9 или отлететь на 200 метров. 

Tab - вид сверху. В нём так же можно перемещать камеру движением мыши с зажатой левой кнопкой, 
 освобождаться\привязываться к транспорту с помощью ПКМ, менять масштаб колёсиком мыши.
 
Включить ТС - Y. Опустить/поднять токоприёмник - T.
Пусковая/ходовая позиция- W (↑), Тормозная позиция - S(↓).  Реверс - Backspace, но ходовая позиция и скорость должны быть равны нулю.
Сброс хода - Alt. Выравнить руль - Пробел.
Стояночный тормоз - V(B).
Поворотник левый - Q, правый - E(W), аварийка - O(E).
Двери - G(S) (Дверь у водителя), H(D) (Остальные). Так же работают и цифры (от клавиши 1 до 9).
Переключение управления: L(A) - с автоматического на полуавтоматическое, M - с полуавтоматического на ручное.

2) Управление трамваем

Трамвай управляется контроллером. 
Позиции контроллера переключаются W и S соответственно. 
Тормозные позиции: ТР, Т4, Т3, Т2, Т1
Выбег - 0
Ходовые позиции: М, Х1, Х2, Х3.
Направление движения меняется клавишей Backspace (только при выключенном контроллере). 
У трамвая есть токоприёмник, его можно поднимать и опускать клавишей T. 
При опущеном токоприёмнике невозможно ускорение, электродинамический тормоз и переключение стрелок. 
Ещё у трамвая есть несколько дверей. Открыть/закрыть первую дверь - клавиша G(S). 
Открыть/закрыть остальные двери - клавиша H(D). Включить/выключить - клавиша Y. 
Указатели поворота переключаются Q и E(W) соответственно. Аварийная сигнализация - клавиша O(E).

Кроме ручного управления, есть автоматическое, т.е. трамвай может самостоятельно управлять собой. 
Клавиша L(A) переключает автоматическое управление, клавиша M - ручное.
В автоматическом режиме трамвай следует по маршруту.

При проезде стрелок: для проезда стрелки влево выключите контроллер (позиция "0"), 
для проезда вправо - поставьте в позицию "М" (в тот момент, когда токоприёмник находится под серой коробкой).
Кроме того, (например, если вы случайно переключили стрелку не туда) можно остановиться у стрелки, 
открыть дверь водителя и нажать Ctrl+A(Ctrl+←) или Ctrl+D(Ctrl+→) (ручное переключение).


3) Управление с помощью джойстика

Управление джойстиком еще в промежуточном варианте.
при незажатой кнопке 5:	axis x, y - поворачивать камеру
при зажатой кнопке 5:	axis x, y, стрелки вверх/вниз - перемещать камеру
rotation z - переключение позиций контроллера
кнопка 1 - открыть/закрыть дверь водителя
кнопка 2 - открыть/закрыть двери
кнопка 3 - опустить/поднять токоприёмник
кнопка 8 - задний ход
кнопка 6 - переключить автоматическое и ручное управление
кнопка 9 - закрепить/освободить камеру от трамвая
кнопка 12- включить/выключить трамвай


4) Управление троллейбусом

Троллейбус управляется так же, как и трамвай. 
Есть несколько отличий. Троллейбус управляется с помощью педалей.
Ходовой педали соответствуют позиции контроллера М, Х1, Х2, Х3, тормозной педали - позиции Т1 и Т2. 
Если дальше нажать тормозную педаль, включается пневматическое торможение (оно работает и при слетевших или опущенных штангах). 
Клавишами W(↑) и S(↓) переключаются позиции педалей (позиции контроллера и пневматическое торможение). 
Клавишами A(←) и D(→) поворачивается руль. Выравнить руль - Пробел.
Клавишами 1, 2, 3 открываются соответственно первая, вторая и третья дверь (клавиши  G(S) и H(D) тоже работают). 
На джойстике при незажатых кнопках 5 и 7 axis x - поворачивать руль, а камера поворачивается при зажатой кнопке 7.
Штанги поднимаются и опускаются кнопкой T. 
Будьте осторожны! Если штанги не дотягиваются до провода, они слетят и не будут подниматся. 
Если при этом троллейбус остановился, то он дальше никуда не поедет! А также не застревайте на пересечках.

При проезде стрелок: 
в момент прохождения стрелки для проезда вправо сбросьте ход (Alt) и не нажимайте педалей (позиция контроллера "0"), 
для проезда влево - нажмите на ходовую педаль и пройдите на маневровой позиции.

5) Управление авотбусом
Режим АКП (автоматическая коробка передач):
Клавишами Z и X (на джойстике - кнопками 7 и 8) 
переключаются режимы коробки передач. Для переключения на/с передачи N (нейтральный), R(задний ход) 
и P(парковка, аналог стояночного тормоза), требуется выжать "Тормоз: 100" клавишей S.
Есть режимы P, R, N, D, 2, 1. 
W(↑) и S(↓) изменяется положение педалей. 
На джойстике камера поворачивается при зажатой кнопке 11. 
Режим РТ (ручная трансмиссия):
Клавишами Z и X (на джойстике - кнопками 7 и 8) 
переключаются режимы коробки передач. Есть передачи: -, R, 1, 2, 3, 4, 5.
Для переключения на передачу R (задний ход), позицию педали нужно сбросить до 0%. 

Всё остальное также, как и у троллейбуса.


Если вы заметили неправильности или неточности в управлении трамвая, троллейбуса или автобуса, сообщите об этом.
Много чего уже было замечено, но пока что не реализовано.


6) Настройки запуска

При запуске программы можно настроить:

• Общие настройки:
	• Карта. Карты загружаются из файлов, их можно редактировать в редакторе.
	• Начальное время. 
	При выборе времени будет показано, сколько трамваев, троллейбусов и автобусов в этот момент находятся на линии, 
	а сколько в парке (те ТС, которые уже ушли в парк и больше не выйдут на линию в этот день, 
	не считаются и не загружаются).
	• Переключение трамвайных и троллейбусных стрелок под током налево (если выключено, то под током направо).
	• Язык. Дистрибутив поставляется с двумя файлами локализаций: русским и английским.
	• Начать с автоматическим управлением. 
	Если включено, при запуске ваш транспорт будет изначально управляться автоматически, если не включено, то в ручную.
	• Поворачивать камеру вместе с транспортом. 
	Если включено, камера будет поворачиваться при повороте транспорта, если не включено, камера будет только перемещаться.

• Настройки игроков. Здесь можно настраивать устройства управления игроков, подвижной состав и начальный маршрут. 
Если у вас есть джойстики, можно сделать несколько игроков (экран разделится на несколько частей).
	• Чтобы запустить игру, нужно в поле ввода ввести что-нибудь (имя игрока) и нажать кнопку Добавить. 
	Выделите игрока в списке, чтобы настроить устройство управления, подвижной состав и начальный маршрут.
	• Управление. Обычно здесь есть только "Клавиатура". 
	Если подключить один или несколько джойстиков, в этом списке будут Клавиатура и названия джойстиков. 
	Джойстик появится в списке, только если он был подключен во время запуска.
	• Подвижной состав. ЛМ-68М - это четырёхосный вагон (Ленинградский Моторный). 
	ЛВС-86 - это шестиосный сочленённый вагон (Ленинградский Вагон Сочленённый). 
	"2 ЛМ-68М" и "2 ЛВС-86" означает, что это поезд из двух вагонов. ЗиУ-682 и ЗиУ-683 - это троллейбусы (Завод им. Урицкого).
	• Маршрут и наряд. 
	При выборе наряда транспорт появляется в том месте, где он должен быть в это время, а если выбрать "Нет",
	транспорт появится в случайном месте (не обязательно на трассе маршрута). 
	В списке маршрутов показываются только маршруты текущего вида транспорта (для трамвая - только трамвайные и т.д.).
	

• Настройки DirectX
	• Разрешение экрана и тип Device'а. Если выбрать "настроить", то можно будет запустить в окне или поменять разрешение игры.
	• Обработка вершин. 
	• Качество кривых рельсов. 
	Это влияет на детализацию кривых рельсов и дорог (и на скорость игры). 
	При минимальном значении кривые рельсы состоят из кусков по 1/5 радиуса (приблизительно), 
	при максимальном - по 1/20 радиуса.
	• Беззвучный режим.
	• Не рисовать текст на значках остановках. 
	Обычно на каждом значке остановки рисуется список маршрутов и их расписание (или интервалы), 
	но это сильно увеличивает время загрузки игры.
	• Не захватывать клавиатуру. 
	В этом режиме будут работать все стандартные сочетания клавиш (например, Print Screen). 
	Если клавиатура "захвачена", то работают только Alt+Tab и Ctrl+Alt+Delete.
	• Не захватывать мышь. Это может быть полезно в оконном режиме при управлении на джойстике (можно спокойно выводить мышь за окно с игрой).
	• Рисовать скайбокс. Скайбокс - это текстурное небо.

7) О кастомизации моделей
	• Объекты хранятся в каталоге Data\Objects. 
	Каждый объект (в т.ч. и светофор, сигнал, остановка) расположен в своей папке. Описание модели объекта производится в 
	файле object.xml.
	• Подвижной состав (ПС) хранится в каталоге Data\Transport. 
	Каждая модель ПС имеет свой каталог. Описание модели производится в файле model.xml.

8) История версий
Основные изменения в версии 0.6.3.3.1:
• Появилась возможность сброса привязки к транспорту на F9.
• Добавлена ручная трансмиссия. Пока что - отдельный вид автобуса.
• Редактор: Добавлена возможность отменить изменение с помощью сочетания клавиш.
• Редактор: Сделан оранжевый цвет контактной сети в редакторе при её редактировании.
• Редактор: Добавлена кнопка, открывающая новое руководство по редактору.
• Редактор: Добавлена возможность делать скриншоты на F10 с различающимся названием.
• Редактор: Добавлены "заготовки на будущее" - кнопки строительства КС одновременно с дорогой и рельсами и галочки "Маршрут с АХ".
• Редактор: Реализован 3D вид с неадекватным поворотом камеры.
• Редактор: Появилась возможность просчтёта маршрута троллейбуса с автономным ходом.
• Редактор: Положение курсора теперь в метрах. (но в режимах редактирования оставлены километры)
• Редактор: Подьём провода, объекта и дороги теперь возможен на 0,1 метра.
• Редактор: Появилась возможность убирать баганные провода на колёсико мыши.
• Появилась возможноть у ботов ездить на автономном ходу, если он конечно у троллейбуса есть.
• Разряд аккумулятора стал настраиваемый. <charge_consumption>0.20</charge_consumption> 

Основные изменения в версии 0.6.3.3 (часть изменений сделал Артемий Данилин Trollebas):
• Изменены клавиши управления, добавились новые. 
Так же оставлена версия со старым управлением. 
Readme обновлён - перед запуском обязательно прочтите!
• Изменён дизайн начального окна настроек игры.
• Редактор: Добавлена новая кнопка в панели сверху - Отменить.
• Редактор: Дороги отображаются правильно.
• Перевод ошибок на русский язык.
• Дороги снова яркие в целях поддержки старых дорог из 0.6.3.1.
• Возможность локализации текста на загрузочном экране, название окна редактора, текст на загрузочном экране редактора.
• Изменён логотип (пока на лого карты Серговск)
• Скриншоты теперь делаются в jpg.

Основные изменения в версии 0.6.3.2:
• Переход на звукой API XAudio2 + X3DAudio.

Основные изменения в версии 0.6.3.1:
• Поддержка кастомных моделей светофоров, сигналов и остановок;
• Множество незначительных изменений и исправлений.

Основные изменения в версии 0.6.3:
• Начальный этап оптимизации потребления памяти;
• Поддержка кастомных сплайнов дорог и рельс;
• Внедрена возможность практически полной локализации игры;
• Множество других изменений в игре и редакторе.

Основные изменения в версии 0.6.2.9:
• Переход на API SlimDX;
• Первый этап оптимизации игры;
• Разделение рельс и трамвайной КС;
• Множество мелких изменений.

Основные изменения в версии 0.6.2.8:
• Переделан алгоритм расчёта скорости для безрельсового транспорта;
• Появилась возможность добавить систему автономного хода для троллейбусов;
• Небольшие изменения в редакторе.

Основные изменения в версии 0.6.2.7:
• Исправлена ошибка, при которой многовагонные трамваи могли расцепиться на стрелке;
• Отныне трамваи могут "видеть" друг друга;
• Теперь при проезде троллейбусной стрелки на высокой скорости (более 25км/ч) штанги будут слетать;
• Добавлена начальная версия "руления" мышкой для колёсного транспорта;
• Добавлена базовая локализация внутриигровых надписей;
• Трамваи загружаются из model.xml;
• Небольшие изменения в редакторе.

Основные изменения в версии 0.6.2.6:
• Решена проблема пропуска остановок;
• Полная совместимость с картами от предыдущих версий игры;
• Из структуры model_tram.xml убран ненужный мусор;
• Для трамваев добавлена система формирования списка остановок рейса;
• Исправление списка остановок рейса: теперь в списке видны только остановки текущего вида транспорта;
• Исправление вылета при отсутствии остановок на рейсе;
• Добавлена начальная версия использования ботами светотехники.

Основные изменения в версии 0.6.2.5:
• Возможность добавления многовагонных трамваев;
• Оптимизация объектов путём добавления функции "Отбрасывать дальние объекты";
• В игру добавлен режим карты.

Основные изменения в версии 0.6.2.1:
• Возможность добавления одиночных трамваев;
• Автоматическое управление возвращено из 0.6.1.

Основные изменения в версии 0.6.2:
• Анимированное рулевое управление;
• Формирование списка остановок для рейса;
• Остановка на которой могут останавливаться одновременно троллейбус и автобус;
• Как всегда немного улучшено автоматическое управление;
• Исправление ошибки при запуске игры с пунктом "Нет" в поле "Наряд" в стартовом окне;
• Исправление ошибки при ручном указании времени прохождения рейса в редакторе;
• Исправление ошибки при смене типа маршрута в редакторе;
• Исправление ошибки при указании типа ПС "Случайный" в нарядах автобусных и троллейбусных маршрутов;
• Исправление ошибки при создании скриншота в полноэкранном режиме.

Основные изменения в версии 0.6.1:
• Исправлен баг доступа к списку подвижного состава на панели "Наряды";
• Исправлен баг отображения маршрутных указателей;
• Добавлена возможность указания текстуры для наряда;
• Добавлен пункт "Случайный" в выпадающее меню "Подвижной состав" на панели "Наряд";
• Добавлена возможность записи скриншота по клавише F10.

Основные изменения в версии 0.6:
• Появилась возможность вставлять объекты(здания, столбы и т.п.) на карту
• отдельные файлы model.xml для каждой модели;
• выбор модели ПС для наряда;
• каждый объект в своем каталоге;
• в стартовом окне при выборе ПС список маршрутов соответствует типу ПС.
• Улучшено автоматическое управление автобусом и троллейбусом.

Основные изменения в версии 0.5:
• Требуемая версия Microsoft .NET Framework теперь 2.0
• Полностью изменилась структура рельсов и маршрутов, появились расписания
• Появились дороги, мосты, светофоры
• Появились троллейбусы и автобусы
• Города загружаются полностью из файлов
• Модели троллейбусов и автобусов тоже загружаются из файла (но редактировать его можно только вручную)
• Редактор может почти полностью редактировать карты
• Огромное количество других изменений

Основные изменения в версии 0.4:
• У вагонов появились остальные двери, окна, боковой маршрутный указатель
• Появились вагоны ЛМ-68М
• Добавлены столбы с остановками, вагон ЛВС-89, а также (по заявкам) прицепной вагон "ЛП-83" в сцепке с ЛМ-68М
• Управление стало немного ближе к реальности
• Появилась возможность перейти к управлению любого другого трамвая
• Существенно изменилась структура рельсов
• Стрелки теперь переключаются более правдоподобно, их положение видимо
• Появились фары и указатели поворотов
• Ускорена производительность
• Появился редактор, который может только просматривать карты

Основные изменения в версии 0.3:
• Появились новые настройки, появилась поддержка нескольких игроков, управления джойстиком
• Изменились некоторые форматы файлов, настройки теперь сохраняются в ini файлах
• Появился экран загрузки, загрузка объектов существенно ускорена
• Улучшилось закрепление камеры на трамваях
• Изменилось управление и изменения скорости
• У трамваев появились 2 окна, 2 двери, маршрутный указатель и сочленение
• В городке появился новый маршрут - "А" и новое кольцо для него
• Улучилось измерение времени
• Изменилось время стоянки на конечной (в зависимости от времени последнего отправления)

Основные изменения в версии 0.2:
• Появилась контактная сеть и токоприёмники у трамваев
• Существенно ускорена производительность (особенно при большом количестве трамваев)
• Изменилось управление
• Появились поезда из двух вагонов
• Улучшено движение и поворот камеры относительно трамвая
• Новое звуковое окружение


9) Авторы моделей и текстур

• Автор моделей троллейбуса ЗиУ-682 и ЗиУ-683: Денис (denisdolgushev@narod.ru, www.mafiadenis.narod.ru)
• Автор модели автобуса ЛиАЗ-6212: Denis, Lexan
• Автор модели автобуса ЛиАЗ-5256: ???
• Автор модели автобуса Паз-32051: Wall-E, LekSTR
• Автор модели автобуса Паз-4234: Himmel
• Автор моделей трамваев ЛВС-86 и ЛМ-68М: 71-630; конвертация: Олег Хлюпин
• Автор модели ЗиУ-682В0А неизвестен.
Эти модели были немножко изменены.

• Все остальные модели созданы автором игры.

Вы можете предоставить для игры свои модели и текстуры, а также звуки.


10) Создатели игры

Эту игру создал Сластенин Саша.
Домашняя страничка : sashaslastenin.narod.ru
Начиная с версии 0.6 игру разрабатывает Николин Андрей.
C версии 0.6.2.1 игру разрабатывает Пермяков Сергей.
Версию 0.6.3.3 и 0.6.3.3.1 разработал Артемий Данилин Trollebas на основе наработок 151 билда игры.

Официальный сайт по игре (умер): https://trancity.ucoz.ru , Группа разработки Артемия Данилина: https://vk.com/trancity_sergovsk, 
Живая беседа по Trancity: https://vk.me/join/jUGhz9zx_O2OK5StDgDJ6Bbn4CGZI97LFdc= 
Живая группа по Trancity: https://vk.com/club197412165